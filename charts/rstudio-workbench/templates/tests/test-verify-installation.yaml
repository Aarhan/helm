apiVersion: v1
kind: Pod
metadata:
  name: {{ include "rstudio-workbench.fullname" . }}-test
  annotations:
   "helm.sh/hook": test
spec:
  {{- if .Values.rbac.create }}
  serviceAccountName: {{ include "rstudio-workbench.fullname" . }}
  {{- end }}
  {{- if and (not .Values.rbac.create) (.Values.serviceAccountName) }}
  serviceAccountName: {{ .Values.serviceAccountName }}
  {{- end }}
  shareProcessNamespace: {{ .Values.shareProcessNamespace }}
  restartPolicy: Never
  {{- $overrideDict := . | deepCopy }}
  {{- $_ := set $overrideDict.Values "enableDiagnostics" true }}
  {{- $_ := set $overrideDict.Values "userCreate" true }}
  {{- $_ := set $overrideDict.Values "readinessProbe.enabled" false }}
  {{- $_ := set $overrideDict.Values "livenessProbe.enabled" false }}
  {{- $_ := set $overrideDict.Values "startupProbe.enabled" false }}
  {{- $_ := set $overrideDict.Values ".Values.prometheusExporter.enabled" false }}
{{ include "rstudio-workbench.containers" $overrideDict | indent 2 }}
